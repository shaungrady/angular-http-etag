{"version":3,"file":null,"sources":["../src/service.js","../src/httpDecorator.js","../src/httpInterceptor.js","../src/cacheServiceAdapters.js","../node_modules/deepcopy/lib/polyfill.js","../node_modules/deepcopy/lib/copy.js","../node_modules/deepcopy/lib/index.js","../node_modules/deepcopy/index.js","../node_modules/object-keys/isArguments.js","../node_modules/object-keys/index.js","../node_modules/array-map/index.js","../src/index.js"],"sourcesContent":["import angular from 'angular'\nimport deepcopy from 'deepcopy'\n\nexport default httpEtagProvider\n\nfunction httpEtagProvider () {\n  var httpEtagProvider = this\n\n  var serviceAdapterMethods = [\n    'createCache',\n    'getCache'\n  ]\n\n  var cacheAdapterMethods = [\n    'setItem',\n    'getItem',\n    'removeItem',\n    'removeAllItems'\n    // info method hard-coded\n  ]\n\n  var requiredAdapterMethods = serviceAdapterMethods.concat(cacheAdapterMethods)\n\n  // Built-in adapters defined in ./cacheServiceAdapters.js\n  var cacheAdapters = {}\n  var cacheDefinitions = {}\n\n  // Cache config defaults\n  var defaultCacheId = 'httpEtagCache'\n  var defaultEtagCacheConfig = {\n    deepCopy: false,\n    cacheResponseData: true,\n    cacheService: '$cacheFactory',\n    cacheOptions: {\n      number: 25\n    }\n  }\n\n  /**\n   * SERVICE PROVIDER\n   * .setDefaultCacheConfig(config)\n   * .defineCache(cacheId, config)\n   * .defineCacheServiceAdapter(serviceName, config)\n   * .getCacheServiceAdapter(serviceName)\n   */\n\n  httpEtagProvider.setDefaultCacheConfig = function httpEtagSetDefaultCacheOptions (config) {\n    defaultEtagCacheConfig = angular.extend({}, defaultEtagCacheConfig, config)\n    return httpEtagProvider\n  }\n\n  httpEtagProvider.getDefaultCacheConfig = function httpEtagGetDefaultCacheOptions () {\n    return defaultEtagCacheConfig\n  }\n\n  httpEtagProvider.defineCache = function httpEtagDefineCache (cacheId, config) {\n    config = angular.extend({}, defaultEtagCacheConfig, config, { id: cacheId })\n    cacheDefinitions[cacheId] = config\n    return httpEtagProvider\n  }\n\n  httpEtagProvider.defineCacheServiceAdapter = function httpEtagDefineCacheServiceAdapter (serviceName, config) {\n    if (!config) throw new Error('Missing cache service adapter configuration')\n    if (!config.methods) throw new Error('Missing cache service adapter configuration methods')\n    angular.forEach(requiredAdapterMethods, function (method) {\n      if (typeof config.methods[method] !== 'function') {\n        throw new Error('Expected cache service adapter method \"' + method + '\" to be a function')\n      }\n    })\n\n    cacheAdapters[serviceName] = config\n    return httpEtagProvider\n  }\n\n  httpEtagProvider.getCacheServiceAdapter = function httpEtagGetCacheServiceAdapter (serviceName) {\n    return cacheAdapters[serviceName]\n  }\n\n  /**\n   * SERVICE\n   * .info()\n   * .getCache(acheId)\n   * .getItemCache(cacheId, itemKey)\n   */\n\n  httpEtagProvider.$get = ['$injector', function httpEtagFactory ($injector) {\n    var httpEtagService = {}\n\n    var services = {}\n    var adaptedServices = {}\n    var caches = {}\n    var adaptedCaches = {}\n\n    // Add default cache if not already defined\n    if (!cacheDefinitions[defaultCacheId]) httpEtagProvider.defineCache(defaultCacheId)\n\n    // Find/inject cache service and create adapted versions\n    angular.forEach(cacheAdapters, function adaptCacheService (adapter, serviceName) {\n      var service = services[serviceName] = window[serviceName] || $injector.get(serviceName)\n      var adaptedService = adaptedServices[serviceName] = {}\n\n      angular.forEach(serviceAdapterMethods, function (method) {\n        adaptedService[method] = angular.bind({}, adapter.methods[method], service)\n      })\n    })\n\n    // Instantiate caches and create adapted versions\n    angular.forEach(cacheDefinitions, function adaptCache (config, cacheId) {\n      adaptedServices[config.cacheService].createCache(cacheId, config)\n      var cache = caches[cacheId] = adaptedServices[config.cacheService].getCache(cacheId)\n      var adaptedCache = adaptedCaches[cacheId] = {}\n      // Determine whether to perform deepcopying or not\n      var serviceDeepCopies = cacheAdapters[config.cacheService].config.storesDeepCopies\n      var deepCopy = !serviceDeepCopies && cacheDefinitions[cacheId].deepCopy\n      var copy = function (value) {\n        return deepCopy ? deepcopy(value) : value\n      }\n\n      angular.forEach(cacheAdapterMethods, function (method) {\n        var adapterMethod = cacheAdapters[config.cacheService].methods[method]\n        var wrappedMethod\n        var wrappedRawMethod\n\n        // Wrap set/get methods to set/get to the `responseData` property of an\n        // object. This is where the $http interceptor stores response data.\n        if (method === 'getItem') {\n          wrappedMethod = function getCacheItemResponseData (cache, itemKey, options) {\n            var cachedData = adapterMethod(cache, itemKey, options)\n            return cachedData && copy(cachedData.responseData)\n          }\n\n          wrappedRawMethod = function getCacheItemData (cache, itemKey, options) {\n            return copy(adapterMethod(cache, itemKey, options))\n          }\n        }\n\n        if (method === 'setItem') {\n          wrappedMethod = function setCacheItemResponseData (cache, itemKey, value, options) {\n            var cachedData = adaptedCache.$getItem(itemKey)\n            value = copy(value)\n\n            if (cachedData && typeof cachedData === 'object') {\n              cachedData.responseData = value\n              value = cachedData\n            } else value = { responseData: value }\n\n            adapterMethod(cache, itemKey, value, options)\n          }\n\n          wrappedRawMethod = function setCacheItemData (cache, itemKey, value, options) {\n            adapterMethod(cache, itemKey, copy(value), options)\n          }\n        }\n\n        adaptedCache[method] = angular.bind({}, (wrappedMethod || adapterMethod), cache)\n        if (wrappedRawMethod) {\n          adaptedCache['$' + method] = angular.bind({}, wrappedRawMethod, cache)\n        }\n      })\n\n      adaptedCache.unsetItem = function adaptedCacheUnsetItemCache (itemKey) {\n        adaptedCache.setItem(itemKey, undefined)\n      }\n      adaptedCache.expireItem = function adaptedCacheUnsetItemCache (itemKey) {\n        var data = adaptedCache.$getItem(itemKey)\n        delete data.etagHeader\n        adaptedCache.$setItem(itemKey, data)\n      }\n      adaptedCache.getItemCache = function adaptedCacheGetItemCache (itemKey) {\n        return httpEtagService.getItemCache(cacheId, itemKey)\n      }\n      adaptedCache.info = function adaptedCacheInfo () {\n        return cacheDefinitions[cacheId]\n      }\n      adaptedCache.isCache = true\n    })\n\n    httpEtagService.info = function httpEtagServiceInfo () {\n      return cacheDefinitions\n    }\n\n    httpEtagService.getCache = function httpEtagServiceGetCache (cacheId) {\n      var cache = adaptedCaches[processCacheId(cacheId)]\n      if (cache) return cache\n    }\n\n    httpEtagService.getItemCache = function httpEtagServiceGeItemCache (cacheId, itemKey) {\n      var cache = httpEtagService.getCache(cacheId)\n      var itemCache = {}\n      if (!cache) return\n\n      var methodMappings = [\n        ['set', 'setItem'],\n        ['get', 'getItem'],\n        ['$set', '$setItem'],\n        ['$get', '$getItem'],\n        ['unset', 'unsetItem'],\n        ['expire', 'expireItem'],\n        ['remove', 'removeItem']\n      ]\n\n      angular.forEach(methodMappings, function mapCacheMethdodsToItemCache (methods) {\n        itemCache[methods[0]] = angular.bind({}, cache[methods[1]], itemKey)\n      })\n\n      itemCache.info = function itemCacheInfo () {\n        var itemCacheInfo = cache.info()\n        itemCacheInfo.itemKey = itemKey\n        return itemCacheInfo\n      }\n\n      itemCache.isItemCache = true\n\n      return itemCache\n    }\n\n    httpEtagService.purgeCaches = function httpEtagPurgeCaches () {\n      angular.forEach(adaptedCaches, function (cache) {\n        cache.removeAllItems()\n      })\n    }\n\n    function processCacheId (cacheId) {\n      var type = typeof cacheId\n      var isDefined = type === 'number' || (type === 'string' && !!cacheId)\n      return isDefined ? cacheId : defaultCacheId\n    }\n\n    return httpEtagService\n  }]\n}\n","import angular from 'angular'\nimport objectKeys from 'object-keys'\nimport arrayMap from 'array-map'\n\nexport default httpEtagHttpDecorator\n\nhttpEtagHttpDecorator.$inject = ['$delegate', 'httpEtag']\n\nfunction httpEtagHttpDecorator ($delegate, httpEtag) {\n  var $http = $delegate\n  var cachableHttpMethods = [\n    'GET',\n    'JSONP'\n  ]\n\n  function $httpDecorator (httpConfig) {\n    var useLegacyPromiseExtensions = httpEtagHttpDecorator.useLegacyPromiseExtensions()\n    var hasConfig = !!httpConfig.etagCache\n    var isCacheableMethod = cachableHttpMethods.indexOf(httpConfig.method) >= 0\n    var isCachable = hasConfig && isCacheableMethod\n    var httpPromise\n\n    if (isCachable) {\n      var etagCacheConfig = processHttpConfigEtagValue(httpConfig)\n      if (etagCacheConfig) {\n        var itemCache = httpEtag.getItemCache(etagCacheConfig.id, etagCacheConfig.itemKey)\n        if (!itemCache) throw new Error('No defined ETag caches match specified cache ID')\n\n        var cacheInfo = itemCache.info()\n        var rawCacheData = itemCache.$get()\n        var cachedEtag = rawCacheData && rawCacheData.etagHeader\n        var cachedResponse = cachedEtag && rawCacheData.responseData\n\n        // Allow easy access to cache in interceptor\n        httpConfig.$$_itemCache = itemCache\n\n        if (cachedEtag) {\n          httpConfig.headers = angular.extend({}, httpConfig.headers, {\n            'If-None-Match': cachedEtag\n          })\n        }\n      }\n    }\n\n    httpPromise = $http.apply($http, arguments)\n    httpEtagPromiseFactory(httpPromise)\n\n    function httpEtagPromiseFactory (httpPromise) {\n      var then = httpPromise.then\n      var success = httpPromise.success\n\n      if (useLegacyPromiseExtensions) {\n        httpPromise.cached = function httpEtagPromiseCached (callback) {\n          if (rawCacheData && cacheInfo.cacheResponseData) {\n            callback(cachedResponse, 'cached', undefined, httpConfig, itemCache)\n          }\n          return httpPromise\n        }\n      } else {\n        httpPromise.cached = function deprecatedEtagPromiseCached () {\n          throw new Error('The method `cached` on the promise returned from `$http` has been disabled.')\n        }\n      }\n\n      httpPromise.ifCached = function httpEtagPromiseIfCached (callback) {\n        if (rawCacheData && cacheInfo.cacheResponseData) {\n          callback({\n            data: cachedResponse,\n            status: 'cached',\n            headers: undefined,\n            config: httpConfig\n          }, itemCache)\n        }\n        return httpPromise\n      }\n\n      httpPromise.then = function httpEtagThenWrapper (successCallback, errorCallback, progressBackCallback) {\n        var thenPromise = then.apply(httpPromise, [\n          successCallback ? httpEtagSuccessWrapper : undefined,\n          errorCallback ? httpEtagErrorWrapper : undefined,\n          progressBackCallback\n        ])\n\n        function httpEtagSuccessWrapper (response) {\n          return successCallback(response, itemCache)\n        }\n\n        function httpEtagErrorWrapper (response) {\n          return errorCallback(response, itemCache)\n        }\n\n        return httpEtagPromiseFactory(thenPromise)\n      }\n\n      if (useLegacyPromiseExtensions && itemCache) {\n        httpPromise.success = function httpEtagPromiseSuccess (callback) {\n          var partializedCallback = partial(callback, undefined, undefined, undefined, undefined, itemCache)\n          return success.apply(httpPromise, [partializedCallback])\n        }\n      }\n\n      return httpPromise\n    }\n\n    return httpPromise\n  }\n\n  // Decorate the cachable shortcut methods, too\n  angular.forEach(cachableHttpMethods, function (httpMethod) {\n    var method = httpMethod.toLowerCase()\n    $httpDecorator[method] = function httpEtagHttpShortcutWrapper (url, config) {\n      config = angular.extend({}, config, {\n        method: httpMethod,\n        url: url\n      })\n\n      return $httpDecorator.call($http, config)\n    }\n  })\n\n  // Copy over all other properties and methods\n  angular.forEach($http, function copyHttpPropertyToDectorator (value, key) {\n    if (!$httpDecorator[key]) $httpDecorator[key] = value\n  })\n\n  /**\n   * HELPERS\n   */\n\n  function processHttpConfigEtagValue (httpConfig) {\n    var etagValue = httpConfig.etagCache\n    var etagValueType = typeof etagValue\n    var etagCacheConfig = {}\n\n    // Evaluate function first\n    if (etagValueType === 'function') {\n      etagValue = etagValue(httpConfig)\n      etagValueType = typeof etagValue\n    }\n\n    // Plain, cache, or itemCache objects\n    if (etagValueType === 'object') {\n      var id, itemKey\n\n      if (etagValue.isCache) {\n        id = etagValue.info().id\n        itemKey = generateCacheItemKey(httpConfig)\n      } else if (etagValue.isItemCache) {\n        id = etagValue.info().id\n        itemKey = etagValue.info().itemKey\n      } else {\n        id = etagValue.id\n        itemKey = etagValue.itemKey || generateCacheItemKey(httpConfig)\n      }\n\n      etagCacheConfig.id = id\n      etagCacheConfig.itemKey = itemKey\n    } else if (etagValueType === 'string') {\n      etagCacheConfig.id = etagValue\n      etagCacheConfig.itemKey = generateCacheItemKey(httpConfig)\n    } else if (etagValue === true) {\n      // Undefined cacheId will use the default cacheId as defined in provider\n      etagCacheConfig.itemKey = generateCacheItemKey(httpConfig)\n    } else return\n    return etagCacheConfig\n  }\n\n  function generateCacheItemKey (httpConfig) {\n    var url = httpConfig.url\n    var params = stringifyParams(httpConfig.params)\n    var joiner = ((params && url.indexOf('?') > 0) ? '&' : '?')\n    var queryString = (params && joiner + params) || ''\n    return url + queryString\n  }\n\n  // Based on npm package \"query-string\"\n  function stringifyParams (obj) {\n    return obj ? arrayMap(objectKeys(obj).sort(), function (key) {\n      var val = obj[key]\n\n      if (angular.isArray(val)) {\n        return arrayMap(val.sort(), function (val2) {\n          return encodeURIComponent(key) + '=' + encodeURIComponent(val2)\n        }).join('&')\n      }\n\n      return encodeURIComponent(key) + '=' + encodeURIComponent(val)\n    }).join('&') : ''\n  }\n\n  // http://ejohn.org/blog/partial-functions-in-javascript/\n  function partial (fn) {\n    var args = Array.prototype.slice.call(arguments, 1)\n    return function () {\n      var arg = 0\n      for (var i = 0; i < args.length && arg < arguments.length; i++) {\n        if (args[i] === undefined) args[i] = arguments[arg++]\n      }\n      return fn.apply(this, args)\n    }\n  }\n\n  return $httpDecorator\n}\n","export default httpEtagInterceptorFactory\n\nfunction httpEtagInterceptorFactory () {\n  function responseInterceptor (response) {\n    var itemCache = response.config.$$_itemCache\n\n    if (itemCache) {\n      var cacheInfo = itemCache.info()\n      var cacheResponseData = cacheInfo.cacheResponseData\n      var etag = response.headers().etag\n      var cacheData = {}\n\n      if (etag) {\n        cacheData.etagHeader = etag\n        if (cacheResponseData) cacheData.responseData = response.data\n        itemCache.$set(cacheData)\n      }\n\n      delete response.config.$$_itemCache\n    }\n\n    return response\n  }\n\n  return {\n    response: responseInterceptor\n  }\n}\n","import angular from 'angular'\n\nexport default cacheAdaptersConfig\n\ncacheAdaptersConfig.$inject = ['httpEtagProvider']\n\nfunction cacheAdaptersConfig (httpEtagProvider) {\n  httpEtagProvider\n\n    .defineCacheServiceAdapter('$cacheFactory', {\n      config: {\n        storesDeepCopies: false\n      },\n      methods: {\n        createCache: function createCache ($cacheFactory, cacheId, options) {\n          $cacheFactory(cacheId, options)\n        },\n        getCache: function getCache ($cacheFactory, cacheId) {\n          return $cacheFactory.get(cacheId)\n        },\n        setItem: function setItem (cache, itemKey, value) {\n          cache.put(itemKey, value)\n        },\n        getItem: function getItem (cache, itemKey) {\n          return cache.get(itemKey)\n        },\n        removeItem: function removeItem (cache, itemKey) {\n          cache.remove(itemKey)\n        },\n        removeAllItems: function removeAllItems (cache, itemKey) {\n          cache.removeAll()\n        }\n      }\n    })\n\n    .defineCacheServiceAdapter('localStorage', {\n      config: {\n        storesDeepCopies: true\n      },\n      methods: {\n        createCache: angular.noop,\n        getCache: function getCache (localStorage, cacheId) {\n          return cacheId\n        },\n        setItem: function setItem (cacheId, itemKey, value) {\n          try {\n            itemKey = cacheId + ':' + itemKey\n            localStorage.setItem(itemKey, JSON.stringify(value))\n          } catch (e) {\n\n          }\n        },\n        getItem: function getItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          return JSON.parse(localStorage.getItem(itemKey))\n        },\n        removeItem: function removeItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          localStorage.removeItem(itemKey)\n        },\n        removeAllItems: function removeAllItems (cacheId, itemKey) {\n          var keyPrefix = cacheId + ':'\n\n          angular.forEach(localStorage, function (value, key) {\n            if (key.indexOf(keyPrefix) === 0) {\n              localStorage.removeItem(key)\n            }\n          })\n        }\n      }\n    })\n\n    .defineCacheServiceAdapter('sessionStorage', {\n      config: {\n        storesDeepCopies: true\n      },\n      methods: {\n        createCache: angular.noop,\n        getCache: function getCache (sessionStorage, cacheId) {\n          return cacheId\n        },\n        setItem: function setItem (cacheId, itemKey, value) {\n          try {\n            itemKey = cacheId + ':' + itemKey\n            sessionStorage.setItem(itemKey, JSON.stringify(value))\n          } catch (e) {\n\n          }\n        },\n        getItem: function getItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          return JSON.parse(sessionStorage.getItem(itemKey))\n        },\n        removeItem: function removeItem (cacheId, itemKey) {\n          itemKey = cacheId + ':' + itemKey\n          sessionStorage.removeItem(itemKey)\n        },\n        removeAllItems: function removeAllItems (cacheId, itemKey) {\n          var keyPrefix = cacheId + ':'\n\n          angular.forEach(sessionStorage, function (value, key) {\n            if (key.indexOf(keyPrefix) === 0) {\n              sessionStorage.removeItem(key)\n            }\n          })\n        }\n      }\n    })\n}\n","'use strict';\n\nexports.__esModule = true;\nvar toString = Object.prototype.toString;\n\nvar isBuffer = typeof Buffer !== 'undefined' ? function isBuffer(obj) {\n  return Buffer.isBuffer(obj);\n} : function isBuffer() {\n  // always return false in browsers\n  return false;\n};\n\nvar getKeys = typeof Object.keys === 'function' ? function getKeys(obj) {\n  return Object.keys(obj);\n} : function getKeys(obj) {\n  var objType = typeof obj;\n\n  if (obj === null || objType !== 'function' && objType !== 'object') {\n    throw new TypeError('obj must be an Object');\n  }\n\n  var resultKeys = [],\n      key = void 0;\n\n  for (key in obj) {\n    Object.prototype.hasOwnProperty.call(obj, key) && resultKeys.push(key);\n  }\n\n  return resultKeys;\n};\n\nvar getSymbols = typeof Symbol === 'function' ? function getSymbols(obj) {\n  return Object.getOwnPropertySymbols(obj);\n} : function getSymbols() {\n  // always return empty Array when Symbol is not supported\n  return [];\n};\n\n// NOTE:\n//\n//   Array.prototype.indexOf is cannot find NaN (in Chrome)\n//   Array.prototype.includes is can find NaN (in Chrome)\n//\n//   this function can find NaN, because use SameValue algorithm\nfunction indexOf(array, s) {\n  if (toString.call(array) !== '[object Array]') {\n    throw new TypeError('array must be an Array');\n  }\n\n  var i = void 0,\n      len = void 0,\n      value = void 0;\n\n  for (i = 0, len = array.length; i < len; ++i) {\n    value = array[i];\n\n    // NOTE:\n    //\n    //   it is SameValue algorithm\n    //   http://stackoverflow.com/questions/27144277/comparing-a-variable-with-itself\n    //\n    // eslint-disable-next-line no-self-compare\n    if (value === s || value !== value && s !== s) {\n      return i;\n    }\n  }\n\n  return -1;\n}\n\nexports.getKeys = getKeys;\nexports.getSymbols = getSymbols;\nexports.indexOf = indexOf;\nexports.isBuffer = isBuffer;","'use strict';\n\nexports.__esModule = true;\nexports.copyValue = exports.copyCollection = exports.copy = void 0;\n\nvar _polyfill = require('./polyfill');\n\nvar toString = Object.prototype.toString;\n\nfunction copy(target, customizer) {\n  var resultValue = copyValue(target);\n\n  if (resultValue !== null) {\n    return resultValue;\n  }\n\n  return copyCollection(target, customizer);\n}\n\nfunction copyCollection(target, customizer) {\n  if (typeof customizer !== 'function') {\n    throw new TypeError('customizer is must be a Function');\n  }\n\n  if (typeof target === 'function') {\n    var source = String(target);\n\n    // NOTE:\n    //\n    //   https://gist.github.com/jdalton/5e34d890105aca44399f\n    //\n    //   - https://gist.github.com/jdalton/5e34d890105aca44399f#gistcomment-1283831\n    //   - http://es5.github.io/#x15\n    //\n    //   native functions does not have prototype:\n    //\n    //       Object.toString.prototype  // => undefined\n    //       (function() {}).prototype  // => {}\n    //\n    //   but cannot detect native constructor:\n    //\n    //       typeof Object     // => 'function'\n    //       Object.prototype  // => {}\n    //\n    //   and cannot detect null binded function:\n    //\n    //       String(Math.abs)\n    //         // => 'function abs() { [native code] }'\n    //\n    //     Firefox, Safari:\n    //       String((function abs() {}).bind(null))\n    //         // => 'function abs() { [native code] }'\n    //\n    //     Chrome:\n    //       String((function abs() {}).bind(null))\n    //         // => 'function () { [native code] }'\n    if (/^\\s*function\\s*\\S*\\([^\\)]*\\)\\s*{\\s*\\[native code\\]\\s*}/.test(source)) {\n      // native function\n      return target;\n    } else {\n      // user defined function\n      return new Function('return ' + String(source))();\n    }\n  }\n\n  var targetClass = toString.call(target);\n\n  if (targetClass === '[object Array]') {\n    return [];\n  }\n\n  if (targetClass === '[object Object]' && target.constructor === Object) {\n    return {};\n  }\n\n  if (targetClass === '[object Date]') {\n    // NOTE:\n    //\n    //   Firefox need to convert\n    //\n    //   Firefox:\n    //     var date = new Date;\n    //     +date;            // 1420909365967\n    //     +new Date(date);  // 1420909365000\n    //     +new Date(+date); // 1420909365967\n    //\n    //   Chrome:\n    //     var date = new Date;\n    //     +date;            // 1420909757913\n    //     +new Date(date);  // 1420909757913\n    //     +new Date(+date); // 1420909757913\n    return new Date(target.getTime());\n  }\n\n  if (targetClass === '[object RegExp]') {\n    // NOTE:\n    //\n    //   Chrome, Safari:\n    //     (new RegExp).source => \"(?:)\"\n    //\n    //   Firefox:\n    //     (new RegExp).source => \"\"\n    //\n    //   Chrome, Safari, Firefox:\n    //     String(new RegExp) => \"/(?:)/\"\n    var regexpText = String(target),\n        slashIndex = regexpText.lastIndexOf('/');\n\n    return new RegExp(regexpText.slice(1, slashIndex), regexpText.slice(slashIndex + 1));\n  }\n\n  if ((0, _polyfill.isBuffer)(target)) {\n    var buffer = new Buffer(target.length);\n\n    target.copy(buffer);\n\n    return buffer;\n  }\n\n  var customizerResult = customizer(target);\n\n  if (customizerResult !== void 0) {\n    return customizerResult;\n  }\n\n  return null;\n}\n\nfunction copyValue(target) {\n  var targetType = typeof target;\n\n  // copy String, Number, Boolean, undefined and Symbol\n  // without null and Function\n  if (target !== null && targetType !== 'object' && targetType !== 'function') {\n    return target;\n  }\n\n  return null;\n}\n\nexports.copy = copy;\nexports.copyCollection = copyCollection;\nexports.copyValue = copyValue;","'use strict';\n\nexports.__esModule = true;\n\nvar _copy = require('./copy');\n\nvar _polyfill = require('./polyfill');\n\nfunction defaultCustomizer(target) {\n  return void 0;\n}\n\nfunction deepcopy(target) {\n  var customizer = arguments.length <= 1 || arguments[1] === void 0 ? defaultCustomizer : arguments[1];\n\n  if (target === null) {\n    // copy null\n    return null;\n  }\n\n  var resultValue = (0, _copy.copyValue)(target);\n\n  if (resultValue !== null) {\n    // copy some primitive types\n    return resultValue;\n  }\n\n  var resultCollection = (0, _copy.copyCollection)(target, customizer),\n      clone = resultCollection !== null ? resultCollection : target;\n\n  var visited = [target],\n      reference = [clone];\n\n  // recursively copy from collection\n  return recursiveCopy(target, customizer, clone, visited, reference);\n}\n\nfunction recursiveCopy(target, customizer, clone, visited, reference) {\n  if (target === null) {\n    // copy null\n    return null;\n  }\n\n  var resultValue = (0, _copy.copyValue)(target);\n\n  if (resultValue !== null) {\n    // copy some primitive types\n    return resultValue;\n  }\n\n  var keys = (0, _polyfill.getKeys)(target).concat((0, _polyfill.getSymbols)(target));\n\n  var i = void 0,\n      len = void 0;\n\n  var key = void 0,\n      value = void 0,\n      index = void 0,\n      resultCopy = void 0,\n      result = void 0,\n      ref = void 0;\n\n  for (i = 0, len = keys.length; i < len; ++i) {\n    key = keys[i];\n    value = target[key];\n    index = (0, _polyfill.indexOf)(visited, value);\n\n    resultCopy = void 0;\n    result = void 0;\n    ref = void 0;\n\n    if (index === -1) {\n      resultCopy = (0, _copy.copy)(value, customizer);\n      result = resultCopy !== null ? resultCopy : value;\n\n      if (value !== null && /^(?:function|object)$/.test(typeof value)) {\n        visited.push(value);\n        reference.push(result);\n      }\n    } else {\n      // circular reference\n      ref = reference[index];\n    }\n\n    clone[key] = ref || recursiveCopy(value, customizer, result, visited, reference);\n  }\n\n  return clone;\n}\n\nexports['default'] = deepcopy;\nmodule.exports = exports['default'];","module.exports = require('./lib');\n","'use strict';\n\nvar toStr = Object.prototype.toString;\n\nmodule.exports = function isArguments(value) {\n\tvar str = toStr.call(value);\n\tvar isArgs = str === '[object Arguments]';\n\tif (!isArgs) {\n\t\tisArgs = str !== '[object Array]' &&\n\t\t\tvalue !== null &&\n\t\t\ttypeof value === 'object' &&\n\t\t\ttypeof value.length === 'number' &&\n\t\t\tvalue.length >= 0 &&\n\t\t\ttoStr.call(value.callee) === '[object Function]';\n\t}\n\treturn isArgs;\n};\n","'use strict';\n\n// modified from https://github.com/es-shims/es5-shim\nvar has = Object.prototype.hasOwnProperty;\nvar toStr = Object.prototype.toString;\nvar slice = Array.prototype.slice;\nvar isArgs = require('./isArguments');\nvar isEnumerable = Object.prototype.propertyIsEnumerable;\nvar hasDontEnumBug = !isEnumerable.call({ toString: null }, 'toString');\nvar hasProtoEnumBug = isEnumerable.call(function () {}, 'prototype');\nvar dontEnums = [\n\t'toString',\n\t'toLocaleString',\n\t'valueOf',\n\t'hasOwnProperty',\n\t'isPrototypeOf',\n\t'propertyIsEnumerable',\n\t'constructor'\n];\nvar equalsConstructorPrototype = function (o) {\n\tvar ctor = o.constructor;\n\treturn ctor && ctor.prototype === o;\n};\nvar excludedKeys = {\n\t$console: true,\n\t$external: true,\n\t$frame: true,\n\t$frameElement: true,\n\t$frames: true,\n\t$innerHeight: true,\n\t$innerWidth: true,\n\t$outerHeight: true,\n\t$outerWidth: true,\n\t$pageXOffset: true,\n\t$pageYOffset: true,\n\t$parent: true,\n\t$scrollLeft: true,\n\t$scrollTop: true,\n\t$scrollX: true,\n\t$scrollY: true,\n\t$self: true,\n\t$webkitIndexedDB: true,\n\t$webkitStorageInfo: true,\n\t$window: true\n};\nvar hasAutomationEqualityBug = (function () {\n\t/* global window */\n\tif (typeof window === 'undefined') { return false; }\n\tfor (var k in window) {\n\t\ttry {\n\t\t\tif (!excludedKeys['$' + k] && has.call(window, k) && window[k] !== null && typeof window[k] === 'object') {\n\t\t\t\ttry {\n\t\t\t\t\tequalsConstructorPrototype(window[k]);\n\t\t\t\t} catch (e) {\n\t\t\t\t\treturn true;\n\t\t\t\t}\n\t\t\t}\n\t\t} catch (e) {\n\t\t\treturn true;\n\t\t}\n\t}\n\treturn false;\n}());\nvar equalsConstructorPrototypeIfNotBuggy = function (o) {\n\t/* global window */\n\tif (typeof window === 'undefined' || !hasAutomationEqualityBug) {\n\t\treturn equalsConstructorPrototype(o);\n\t}\n\ttry {\n\t\treturn equalsConstructorPrototype(o);\n\t} catch (e) {\n\t\treturn false;\n\t}\n};\n\nvar keysShim = function keys(object) {\n\tvar isObject = object !== null && typeof object === 'object';\n\tvar isFunction = toStr.call(object) === '[object Function]';\n\tvar isArguments = isArgs(object);\n\tvar isString = isObject && toStr.call(object) === '[object String]';\n\tvar theKeys = [];\n\n\tif (!isObject && !isFunction && !isArguments) {\n\t\tthrow new TypeError('Object.keys called on a non-object');\n\t}\n\n\tvar skipProto = hasProtoEnumBug && isFunction;\n\tif (isString && object.length > 0 && !has.call(object, 0)) {\n\t\tfor (var i = 0; i < object.length; ++i) {\n\t\t\ttheKeys.push(String(i));\n\t\t}\n\t}\n\n\tif (isArguments && object.length > 0) {\n\t\tfor (var j = 0; j < object.length; ++j) {\n\t\t\ttheKeys.push(String(j));\n\t\t}\n\t} else {\n\t\tfor (var name in object) {\n\t\t\tif (!(skipProto && name === 'prototype') && has.call(object, name)) {\n\t\t\t\ttheKeys.push(String(name));\n\t\t\t}\n\t\t}\n\t}\n\n\tif (hasDontEnumBug) {\n\t\tvar skipConstructor = equalsConstructorPrototypeIfNotBuggy(object);\n\n\t\tfor (var k = 0; k < dontEnums.length; ++k) {\n\t\t\tif (!(skipConstructor && dontEnums[k] === 'constructor') && has.call(object, dontEnums[k])) {\n\t\t\t\ttheKeys.push(dontEnums[k]);\n\t\t\t}\n\t\t}\n\t}\n\treturn theKeys;\n};\n\nkeysShim.shim = function shimObjectKeys() {\n\tif (Object.keys) {\n\t\tvar keysWorksWithArguments = (function () {\n\t\t\t// Safari 5.0 bug\n\t\t\treturn (Object.keys(arguments) || '').length === 2;\n\t\t}(1, 2));\n\t\tif (!keysWorksWithArguments) {\n\t\t\tvar originalKeys = Object.keys;\n\t\t\tObject.keys = function keys(object) {\n\t\t\t\tif (isArgs(object)) {\n\t\t\t\t\treturn originalKeys(slice.call(object));\n\t\t\t\t} else {\n\t\t\t\t\treturn originalKeys(object);\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t} else {\n\t\tObject.keys = keysShim;\n\t}\n\treturn Object.keys || keysShim;\n};\n\nmodule.exports = keysShim;\n","module.exports = function (xs, f) {\n    if (xs.map) return xs.map(f);\n    var res = [];\n    for (var i = 0; i < xs.length; i++) {\n        var x = xs[i];\n        if (hasOwn.call(xs, i)) res.push(f(x, i, xs));\n    }\n    return res;\n};\n\nvar hasOwn = Object.prototype.hasOwnProperty;\n","import angular from 'angular'\nimport service from './service'\nimport httpDecorator from './httpDecorator'\nimport httpInterceptor from './httpInterceptor'\nimport cacheServiceAdapters from './cacheServiceAdapters'\n\nexport default angular\n  .module('http-etag', [])\n  .provider('httpEtag', service)\n  .config(cacheServiceAdapters)\n  .config(['$provide', '$httpProvider', function addHttpEtagInterceptor ($provide, $httpProvider) {\n    httpDecorator.useLegacyPromiseExtensions =\n      $httpProvider.useLegacyPromiseExtensions ||\n      function useLegacyPromiseExtensions () { return true }\n    $provide.decorator('$http', httpDecorator)\n    $httpProvider.interceptors.push(httpInterceptor)\n  }])\n  .name\n"],"names":["httpEtagProvider","this","serviceAdapterMethods","cacheAdapterMethods","requiredAdapterMethods","concat","cacheAdapters","cacheDefinitions","defaultCacheId","defaultEtagCacheConfig","deepCopy","cacheResponseData","cacheService","cacheOptions","number","setDefaultCacheConfig","config","angular","extend","getDefaultCacheConfig","defineCache","cacheId","id","defineCacheServiceAdapter","serviceName","Error","methods","forEach","method","getCacheServiceAdapter","$get","$injector","processCacheId","type","isDefined","httpEtagService","services","adaptedServices","caches","adaptedCaches","adapter","service","window","get","adaptedService","bind","createCache","cache","getCache","adaptedCache","serviceDeepCopies","storesDeepCopies","copy","value","deepcopy","wrappedMethod","wrappedRawMethod","adapterMethod","itemKey","options","cachedData","responseData","$getItem","unsetItem","setItem","undefined","expireItem","data","etagHeader","$setItem","getItemCache","info","isCache","itemCache","methodMappings","itemCacheInfo","isItemCache","purgeCaches","removeAllItems","httpEtagHttpDecorator","$delegate","httpEtag","$httpDecorator","httpConfig","httpEtagPromiseFactory","httpPromise","then","success","useLegacyPromiseExtensions","cached","callback","rawCacheData","cacheInfo","cachedResponse","ifCached","status","headers","successCallback","errorCallback","progressBackCallback","httpEtagSuccessWrapper","response","httpEtagErrorWrapper","thenPromise","apply","partializedCallback","partial","hasConfig","etagCache","isCacheableMethod","cachableHttpMethods","indexOf","isCachable","etagCacheConfig","processHttpConfigEtagValue","cachedEtag","$$_itemCache","If-None-Match","$http","arguments","etagValue","etagValueType","generateCacheItemKey","url","params","stringifyParams","joiner","queryString","obj","arrayMap","objectKeys","sort","key","val","isArray","val2","encodeURIComponent","join","fn","args","Array","prototype","slice","call","arg","i","length","httpMethod","toLowerCase","httpEtagInterceptorFactory","responseInterceptor","etag","cacheData","$set","cacheAdaptersConfig","$cacheFactory","put","getItem","removeItem","remove","removeAll","noop","localStorage","JSON","stringify","e","parse","keyPrefix","sessionStorage","array","s","toString","TypeError","len","exports","Object","isBuffer","Buffer","getKeys","keys","objType","resultKeys","hasOwnProperty","push","getSymbols","Symbol","getOwnPropertySymbols","target","customizer","resultValue","copyValue","copyCollection","source","String","test","Function","targetClass","constructor","Date","getTime","regexpText","slashIndex","lastIndexOf","RegExp","_polyfill","buffer","customizerResult","targetType","require$$0","defaultCustomizer","_copy","resultCollection","clone","visited","reference","recursiveCopy","index","resultCopy","result","ref","require$$1","module","toStr","str","isArgs","callee","has","isEnumerable","propertyIsEnumerable","hasDontEnumBug","hasProtoEnumBug","dontEnums","equalsConstructorPrototype","o","ctor","excludedKeys","$console","$external","$frame","$frameElement","$frames","$innerHeight","$innerWidth","$outerHeight","$outerWidth","$pageXOffset","$pageYOffset","$parent","$scrollLeft","$scrollTop","$scrollX","$scrollY","$self","$webkitIndexedDB","$webkitStorageInfo","$window","hasAutomationEqualityBug","k","equalsConstructorPrototypeIfNotBuggy","keysShim","object","isObject","isFunction","isArguments","isString","theKeys","skipProto","j","name","skipConstructor","shim","keysWorksWithArguments","originalKeys","xs","f","map","res","x","hasOwn","$inject","provider","cacheServiceAdapters","$provide","$httpProvider","httpDecorator","decorator","interceptors","httpInterceptor"],"mappings":"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"}